"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const querystring = require("querystring");
class XeroError extends Error {
    constructor(statusCode, data, headers) {
        let message = 'XeroError:';
        const queryobj = querystring.parse(data);
        if (queryobj.oauth_problem && queryobj.oauth_problem_advice) {
            if (statusCode == 503 && headers) {
                message += ' ' + (headers['x-rate-limit-problem'] || headers['X-Rate-Limit-Problem'] || '');
            }
            message += ` ${queryobj.oauth_problem} (${queryobj.oauth_problem_advice})`;
        }
        else {
            message += ` statusCode=${statusCode} data=${data}`;
        }
        super(message);
        // https://github.com/Microsoft/TypeScript/issues/13965#issuecomment-278570200
        this.__proto__ = new.target.prototype;
        this.statusCode = statusCode;
        this.data = data;
        this.headers = headers;
    }
}
exports.XeroError = XeroError;
//# sourceMappingURL=XeroError.js.map