{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _defineProperty from \"/var/www/domains/oxens.ezxdemo.com/public_html/vendor/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) { var it; if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") { if (it) o = it; var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useEffect, useState } from 'react';\nimport styles from '../../styles/cart.module.css';\nimport { Row, Col, Modal, ModalHeader, ModalBody, ModalFooter, Form, FormGroup, Label, Input } from 'reactstrap';\nimport Link from 'next/link';\nimport QuantityBtn from '../quantityBtn';\nimport _ from \"lodash\";\nimport { manageCartData } from '../../reducers/mainSlice';\nimport { useDispatch } from 'react-redux';\nimport \"../../styles/cartModel.css\";\nexport default function Cart(props) {\n  var dispatch = useDispatch();\n\n  var _useState = useState({}),\n      variant = _useState[0],\n      setVariant = _useState[1];\n\n  var _useState2 = useState(null),\n      item = _useState2[0],\n      setItem = _useState2[1];\n\n  var _useState3 = useState(0.00),\n      itemPrice = _useState3[0],\n      setItemPrice = _useState3[1];\n\n  var _useState4 = useState(1),\n      quantity = _useState4[0],\n      setQuantity = _useState4[1];\n\n  var _useState5 = useState({}),\n      tempChildData = _useState5[0],\n      setTempChildData = _useState5[1];\n\n  var getQuantity = function getQuantity(data) {\n    setQuantity(data);\n  };\n\n  var resetChildDep = function resetChildDep(data) {\n    // console.log('data',data);\n    var tempChild = {};\n\n    if (Object.keys(data).length != 0) {\n      Object.keys(data).map(function (childDep) {\n        var selectedInput = document.querySelector(\"input[name=\\\"\".concat(childDep, \"\\\"]:checked\"));\n        var selValue = selectedInput ? selectedInput.value : '';\n        data[childDep].childCus.map(function (tempCus) {\n          var childCus = props.item.customize.filter(function (dataCus) {\n            return dataCus.dependent_with == tempCus._id;\n          });\n\n          if (childCus.length != 0) {\n            tempChild[tempCus._id] = {\n              childCus: childCus,\n              data: data\n            };\n          }\n\n          var varListRow = [];\n          tempCus.variants.map(function (varList) {\n            var price = varList.dependent_price.find(function (raw) {\n              return raw.varientId == selValue;\n            });\n\n            if (price !== undefined) {\n              varListRow.push({\n                _id: varList._id,\n                title: varList.title,\n                price: price,\n                isDefault: varList.isDefault\n              });\n            }\n          });\n          variant[childDep][tempCus._id] = varListRow;\n        });\n      });\n      setVariant(_objectSpread({}, variant));\n      setTempChildData(tempChild);\n    }\n  };\n\n  var handelChange = function handelChange(e) {\n    var cusId = e.currentTarget.name;\n    var type = e.currentTarget.type;\n    var tempChild = {};\n\n    if (type == 'radio') {\n      var depCus = props.item.customize.filter(function (dataCus) {\n        return dataCus.dependent_with == cusId;\n      });\n\n      if (depCus.length != 0) {\n        depCus.map(function (data) {\n          var childCus = props.item.customize.filter(function (dataCus) {\n            return dataCus.dependent_with == data._id;\n          });\n\n          if (childCus.length != 0) {\n            // console.log(data.title,' childCus',childCus);\n            tempChild[data._id] = {\n              childCus: childCus,\n              data: data\n            };\n          }\n\n          var varListRow = [];\n          data.variants.map(function (varList) {\n            var price = varList.dependent_price.find(function (raw) {\n              return raw.varientId == e.currentTarget.value;\n            });\n\n            if (price !== undefined) {\n              varListRow.push({\n                _id: varList._id,\n                title: varList.title,\n                price: price,\n                isDefault: varList.isDefault\n              });\n            }\n          });\n          variant[cusId][data._id] = varListRow;\n        });\n        setVariant(_objectSpread({}, variant));\n        setTempChildData(tempChild);\n      }\n    }\n\n    calculatePrice();\n  };\n\n  var calculatePrice = function calculatePrice() {\n    var tempPrice = Number(item.price);\n    console.log(\"item price\", tempPrice);\n    item.customize.map(function (data) {\n      var inputs = document.querySelectorAll(\"input[name=\\\"\".concat(data._id, \"\\\"]\"));\n\n      var _iterator = _createForOfIteratorHelper(inputs),\n          _step;\n\n      try {\n        for (_iterator.s(); !(_step = _iterator.n()).done;) {\n          var input = _step.value;\n\n          if (input.checked) {\n            tempPrice += Number(input.getAttribute('price'));\n          }\n        }\n      } catch (err) {\n        _iterator.e(err);\n      } finally {\n        _iterator.f();\n      }\n    }); // console.log('tempPrice',tempPrice);\n\n    setItemPrice(tempPrice * quantity);\n  };\n\n  var addItemToCart = function addItemToCart() {\n    var cart = localStorage.getItem('cart') ? JSON.parse(localStorage.getItem('cart')) : {\n      orderItems: {},\n      storeId: props.storeId,\n      totalQuantity: 0,\n      totalAmount: 0.00,\n      orderType: 0\n    };\n    var latestGroup = cart.orderItems[item._id] ? cart.orderItems[item._id].latestGroup : [];\n    var selectedGroup = cart.orderItems[item._id] ? cart.orderItems[item._id].selectedGroup : {};\n    /* find all checked input and group tham start*/\n\n    var checkedInputs = {};\n    item.customize.map(function (data) {\n      var groupCheckInput = [];\n      var inputs = document.querySelectorAll(\"input[name=\\\"\".concat(data._id, \"\\\"]\"));\n\n      var _iterator2 = _createForOfIteratorHelper(inputs),\n          _step2;\n\n      try {\n        for (_iterator2.s(); !(_step2 = _iterator2.n()).done;) {\n          var input = _step2.value;\n          if (input.checked) groupCheckInput.push(input);\n        }\n      } catch (err) {\n        _iterator2.e(err);\n      } finally {\n        _iterator2.f();\n      }\n\n      checkedInputs[data._id] = groupCheckInput;\n    });\n    /* find all checked input and group tham End*/\n\n    /* Find and create a selected group start */\n\n    var selectedGroupRaw = [];\n    var groupKey = item._id + \"_\";\n    Object.keys(checkedInputs).map(function (inputs) {\n      groupKey += inputs.slice(inputs.length - 6);\n      var selectedCustom = item.customize.find(function (cus) {\n        return cus._id == inputs;\n      });\n      var varListRow = [];\n      checkedInputs[inputs].map(function (input) {\n        var tempVar = selectedCustom.variants.find(function (list) {\n          return list._id == input.value;\n        });\n        groupKey += '_' + tempVar._id.slice(tempVar._id.length - 6);\n        varListRow.push({\n          _id: tempVar._id,\n          title: tempVar.title,\n          price: input.getAttribute('price')\n        });\n      });\n\n      if (varListRow.length != 0) {\n        selectedGroupRaw.push({\n          _id: selectedCustom._id,\n          title: selectedCustom.title,\n          is_multiple: selectedCustom.is_multiple,\n          variants: varListRow\n        });\n      }\n    });\n    selectedGroup[groupKey] = {\n      group: selectedGroupRaw,\n      quantity: selectedGroup[groupKey] ? selectedGroup[groupKey].quantity + quantity : quantity,\n      price: selectedGroup[groupKey] ? selectedGroup[groupKey].price + itemPrice : itemPrice\n    };\n    latestGroup = selectedGroupRaw;\n    /* Find and create a selected group end */\n\n    /* set cart data to a spacific format start*/\n\n    cart.orderItems[item._id] = {\n      menuitem: item,\n      selectedGroup: selectedGroup,\n      latestGroup: latestGroup,\n      itemQuantity: cart.orderItems[item._id] ? cart.orderItems[item._id].itemQuantity + quantity : quantity,\n      itemPrice: cart.orderItems[item._id] ? cart.orderItems[item._id].itemPrice + itemPrice : itemPrice\n    };\n\n    if (!cart.storeId) {\n      cart.storeId = props.storeId;\n    }\n\n    cart.totalQuantity += quantity;\n    cart.totalAmount += itemPrice;\n    localStorage.setItem('cart', JSON.stringify(cart));\n    dispatch(manageCartData());\n    props.toggle();\n    /* set cart data to a spacific format end*/\n  };\n\n  useEffect(function () {\n    if (props.item) {\n      setTempChildData({});\n      var depCustom = props.item.customize.filter(function (list) {\n        return list.is_dependent;\n      });\n      var depVarObj = {};\n      depCustom.map(function (data) {\n        var dWithId = data['dependent_with'];\n        var varListRow = [];\n        var dependentCustome = props.item.customize.find(function (dataCus) {\n          return dataCus._id == data.dependent_with;\n        });\n        var defaultSelectedVarID = dependentCustome.variants.find(function (defVar) {\n          return defVar.isDefault == true;\n        });\n\n        if (defaultSelectedVarID !== undefined) {\n          data.variants.map(function (varList) {\n            var price = varList.dependent_price.find(function (raw) {\n              return raw.varientId == defaultSelectedVarID._id;\n            });\n\n            if (price !== undefined) {\n              varListRow.push({\n                _id: varList._id,\n                title: varList.title,\n                price: price,\n                isDefault: varList.isDefault\n              });\n            }\n          });\n        }\n\n        if (!variant.hasOwnProperty(dWithId)) {\n          depVarObj = {};\n          depVarObj[data['_id']] = varListRow;\n        } else {\n          depVarObj = variant[dWithId];\n          depVarObj[data['_id']] = varListRow;\n        }\n\n        variant[dWithId] = depVarObj;\n      });\n      setVariant(_objectSpread({}, variant));\n    }\n\n    setItem(props.item);\n  }, [props.item]);\n  useEffect(function () {\n    if (item) {\n      calculatePrice(); // console.log('tempChildData',tempChildData);\n\n      if (Object.keys(tempChildData).length != 0) resetChildDep(tempChildData);\n    }\n  }, [variant, quantity]);\n  console.log(\"item\", item);\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsxs(Modal, {\n      isOpen: props.isOpen,\n      className: \"\".concat(styles.ModalCustom, \" modal-dialog-scrollable\"),\n      children: [/*#__PURE__*/_jsxs(ModalHeader, {\n        className: \"modelHeader\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"modelHeaderTitle\",\n          children: item ? item.title : ''\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"bg-close\",\n          onClick: props.toggle\n        })]\n      }), /*#__PURE__*/_jsx(ModalBody, {\n        className: \"modelBody\",\n        children: /*#__PURE__*/_jsxs(Row, {\n          children: [/*#__PURE__*/_jsx(Col, {\n            lg: \"3\",\n            children: /*#__PURE__*/_jsx(\"span\", {\n              className: \"itemImageBox\",\n              children: /*#__PURE__*/_jsx(\"img\", {\n                src: item && (item === null || item === void 0 ? void 0 : item.image),\n                className: \"itemImage\",\n                alt: \"Cart\"\n              })\n            })\n          }), /*#__PURE__*/_jsxs(Col, {\n            lg: \"9\",\n            className: \"itemDetails p-0\",\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              className: \"itemPrice\",\n              children: [\"\\xA3\", item ? Number(item === null || item === void 0 ? void 0 : item.price) : '']\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: \"itemDescription\",\n              children: item ? item === null || item === void 0 ? void 0 : item.description : ''\n            })]\n          }), /*#__PURE__*/_jsx(Col, {\n            lg: \"12\",\n            className: \"allItemsBody\",\n            children: item && item.customize ? item.customize.map(function (cusList) {\n              return cusList.is_dependent ? Object.keys(variant).length != 0 && variant[cusList.dependent_with][cusList._id].length != 0 ? /*#__PURE__*/_jsxs(\"div\", {\n                id: cusList._id,\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \"\".concat(styles.titleOptional, \" modelItemTitle \"),\n                  children: cusList.title\n                }), /*#__PURE__*/_jsx(Form, {\n                  id: \"var_\".concat(cusList._id),\n                  className: \"cat\",\n                  children: variant[cusList.dependent_with][cusList._id].map(function (varList) {\n                    return /*#__PURE__*/_jsx(FormGroup, {\n                      style: {\n                        marginBottom: \"0\"\n                      },\n                      children: /*#__PURE__*/_jsxs(Label, {\n                        children: [/*#__PURE__*/_jsx(Input, {\n                          name: cusList._id,\n                          value: varList._id,\n                          price: varList.price.price,\n                          type: cusList.is_multiple ? \"checkbox\" : \"radio\",\n                          className: \"\".concat(styles.checkInput),\n                          onChange: handelChange,\n                          defaultChecked: varList.isDefault ? true : false\n                        }), /*#__PURE__*/_jsxs(\"span\", {\n                          children: [/*#__PURE__*/_jsx(\"p\", {\n                            className: \"\".concat(cusList.is_multiple ? styles.checkmark : styles.radio)\n                          }), /*#__PURE__*/_jsxs(\"p\", {\n                            className: \"\".concat(styles.checktext),\n                            style: {\n                              margin: \"0\",\n                              fontWeight: \"700\"\n                            },\n                            children: [varList.title, \" \\xA3\", varList.price.price]\n                          })]\n                        })]\n                      })\n                    }, varList._id);\n                  })\n                })]\n              }, cusList._id) : '' : cusList.variants && cusList.variants.length != 0 ? /*#__PURE__*/_jsxs(\"div\", {\n                id: cusList._id,\n                children: [/*#__PURE__*/_jsx(\"div\", {\n                  className: \"\".concat(styles.titleOptional, \" modelItemTitle\"),\n                  children: cusList.title\n                }), /*#__PURE__*/_jsx(Form, {\n                  id: \"var_\".concat(cusList._id),\n                  className: \"cat\",\n                  children: cusList.variants.map(function (varList) {\n                    return /*#__PURE__*/_jsx(FormGroup, {\n                      style: {\n                        marginBottom: \"0\"\n                      },\n                      children: /*#__PURE__*/_jsxs(Label, {\n                        children: [/*#__PURE__*/_jsx(Input, {\n                          name: cusList._id,\n                          value: varList._id,\n                          price: varList.price,\n                          type: cusList.is_multiple ? \"checkbox\" : \"radio\",\n                          className: \"\".concat(styles.checkInput),\n                          onChange: handelChange,\n                          defaultChecked: varList.isDefault ? true : false\n                        }), /*#__PURE__*/_jsxs(\"span\", {\n                          children: [/*#__PURE__*/_jsx(\"p\", {\n                            className: \"\".concat(cusList.is_multiple ? styles.checkmark : styles.radio)\n                          }), /*#__PURE__*/_jsxs(\"p\", {\n                            className: \"\".concat(styles.checktext),\n                            style: {\n                              margin: \"0\",\n                              fontWeight: \"700\"\n                            },\n                            children: [varList.title, \" \\xA3\", varList.price]\n                          })]\n                        })]\n                      })\n                    }, varList._id);\n                  })\n                })]\n              }, cusList._id) : \"\";\n            }) : ''\n          })]\n        })\n      }), /*#__PURE__*/_jsxs(ModalFooter, {\n        className: \"modelFooter\",\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"footerQuantityBtn\",\n          children: /*#__PURE__*/_jsx(QuantityBtn, {\n            defvalue: 1,\n            minValue: 1,\n            getQuantity: getQuantity\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"footerADDtoCartBtn\",\n          role: \"button\",\n          onClick: addItemToCart,\n          children: /*#__PURE__*/_jsxs(\"a\", {\n            className: \"\".concat(styles.themeBtn),\n            children: [\"Add to Cart - \", /*#__PURE__*/_jsxs(\"span\", {\n              children: [\"\\xA3\", itemPrice]\n            })]\n          })\n        })]\n      })]\n    })\n  });\n}","map":null,"metadata":{},"sourceType":"module"}