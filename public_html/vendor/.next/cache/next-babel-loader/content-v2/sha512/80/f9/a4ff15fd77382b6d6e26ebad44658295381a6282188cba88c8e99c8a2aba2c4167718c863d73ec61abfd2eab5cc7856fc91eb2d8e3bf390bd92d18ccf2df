{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/var/www/domains/oxens.ezxdemo.com/public_html/vendor/components/Model/Cart.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useEffect, useState } from 'react';\nimport styles from '../../styles/cart.module.css';\nimport { Row, Col, Modal, ModalHeader, ModalBody, ModalFooter, Form, FormGroup, Label, Input } from 'reactstrap';\nimport Link from 'next/link';\nimport QuantityBtn from '../quantityBtn';\nimport _ from \"lodash\";\nimport { manageCartData } from '../../reducers/mainSlice';\nimport { useDispatch } from 'react-redux';\nimport \"../../styles/cartModel.css\";\nexport default function Cart(props) {\n  const dispatch = useDispatch();\n  const {\n    0: variant,\n    1: setVariant\n  } = useState({});\n  const {\n    0: item,\n    1: setItem\n  } = useState(null);\n  const {\n    0: itemPrice,\n    1: setItemPrice\n  } = useState(0.00);\n  const {\n    0: quantity,\n    1: setQuantity\n  } = useState(1);\n  const {\n    0: tempChildData,\n    1: setTempChildData\n  } = useState({});\n\n  const getQuantity = data => {\n    setQuantity(data);\n  };\n\n  const resetChildDep = data => {\n    // console.log('data',data);\n    let tempChild = {};\n\n    if (Object.keys(data).length != 0) {\n      Object.keys(data).map(childDep => {\n        let selectedInput = document.querySelector(`input[name=\"${childDep}\"]:checked`);\n        let selValue = selectedInput ? selectedInput.value : '';\n        data[childDep].childCus.map(tempCus => {\n          let childCus = props.item.customize.filter(dataCus => dataCus.dependent_with == tempCus._id);\n\n          if (childCus.length != 0) {\n            tempChild[tempCus._id] = {\n              childCus: childCus,\n              data: data\n            };\n          }\n\n          let varListRow = [];\n          tempCus.variants.map(varList => {\n            let price = varList.dependent_price.find(raw => raw.varientId == selValue);\n\n            if (price !== undefined) {\n              varListRow.push({\n                _id: varList._id,\n                title: varList.title,\n                price: price,\n                isDefault: varList.isDefault\n              });\n            }\n          });\n          variant[childDep][tempCus._id] = varListRow;\n        });\n      });\n      setVariant(_objectSpread({}, variant));\n      setTempChildData(tempChild);\n    }\n  };\n\n  const handelChange = e => {\n    let cusId = e.currentTarget.name;\n    let type = e.currentTarget.type;\n    let tempChild = {};\n\n    if (type == 'radio') {\n      let depCus = props.item.customize.filter(dataCus => dataCus.dependent_with == cusId);\n\n      if (depCus.length != 0) {\n        depCus.map(data => {\n          let childCus = props.item.customize.filter(dataCus => dataCus.dependent_with == data._id);\n\n          if (childCus.length != 0) {\n            // console.log(data.title,' childCus',childCus);\n            tempChild[data._id] = {\n              childCus: childCus,\n              data: data\n            };\n          }\n\n          let varListRow = [];\n          data.variants.map(varList => {\n            let price = varList.dependent_price.find(raw => raw.varientId == e.currentTarget.value);\n\n            if (price !== undefined) {\n              varListRow.push({\n                _id: varList._id,\n                title: varList.title,\n                price: price,\n                isDefault: varList.isDefault\n              });\n            }\n          });\n          variant[cusId][data._id] = varListRow;\n        });\n        setVariant(_objectSpread({}, variant));\n        setTempChildData(tempChild);\n      }\n    }\n\n    calculatePrice();\n  };\n\n  const calculatePrice = () => {\n    let tempPrice = Number(item.price);\n    console.log(\"item price\", tempPrice);\n    item.customize.map(data => {\n      let inputs = document.querySelectorAll(`input[name=\"${data._id}\"]`);\n\n      for (const input of inputs) {\n        if (input.checked) {\n          tempPrice += Number(input.getAttribute('price'));\n        }\n      }\n    }); // console.log('tempPrice',tempPrice);\n\n    setItemPrice(tempPrice * quantity);\n  };\n\n  const addItemToCart = () => {\n    let cart = localStorage.getItem('cart') ? JSON.parse(localStorage.getItem('cart')) : {\n      orderItems: {},\n      storeId: props.storeId,\n      totalQuantity: 0,\n      totalAmount: 0.00,\n      orderType: 0\n    };\n    let latestGroup = cart.orderItems[item._id] ? cart.orderItems[item._id].latestGroup : [];\n    let selectedGroup = cart.orderItems[item._id] ? cart.orderItems[item._id].selectedGroup : {};\n    /* find all checked input and group tham start*/\n\n    let checkedInputs = {};\n    item.customize.map(data => {\n      let groupCheckInput = [];\n      let inputs = document.querySelectorAll(`input[name=\"${data._id}\"]`);\n\n      for (const input of inputs) {\n        if (input.checked) groupCheckInput.push(input);\n      }\n\n      checkedInputs[data._id] = groupCheckInput;\n    });\n    /* find all checked input and group tham End*/\n\n    /* Find and create a selected group start */\n\n    let selectedGroupRaw = [];\n    let groupKey = item._id + \"_\";\n    Object.keys(checkedInputs).map(inputs => {\n      groupKey += inputs.slice(inputs.length - 6);\n      let selectedCustom = item.customize.find(cus => cus._id == inputs);\n      let varListRow = [];\n      checkedInputs[inputs].map(input => {\n        let tempVar = selectedCustom.variants.find(list => list._id == input.value);\n        groupKey += '_' + tempVar._id.slice(tempVar._id.length - 6);\n        varListRow.push({\n          _id: tempVar._id,\n          title: tempVar.title,\n          price: input.getAttribute('price')\n        });\n      });\n\n      if (varListRow.length != 0) {\n        selectedGroupRaw.push({\n          _id: selectedCustom._id,\n          title: selectedCustom.title,\n          is_multiple: selectedCustom.is_multiple,\n          variants: varListRow\n        });\n      }\n    });\n    selectedGroup[groupKey] = {\n      group: selectedGroupRaw,\n      quantity: selectedGroup[groupKey] ? selectedGroup[groupKey].quantity + quantity : quantity,\n      price: selectedGroup[groupKey] ? selectedGroup[groupKey].price + itemPrice : itemPrice\n    };\n    latestGroup = selectedGroupRaw;\n    /* Find and create a selected group end */\n\n    /* set cart data to a spacific format start*/\n\n    cart.orderItems[item._id] = {\n      menuitem: item,\n      selectedGroup: selectedGroup,\n      latestGroup: latestGroup,\n      itemQuantity: cart.orderItems[item._id] ? cart.orderItems[item._id].itemQuantity + quantity : quantity,\n      itemPrice: cart.orderItems[item._id] ? cart.orderItems[item._id].itemPrice + itemPrice : itemPrice\n    };\n\n    if (!cart.storeId) {\n      cart.storeId = props.storeId;\n    }\n\n    cart.totalQuantity += quantity;\n    cart.totalAmount += itemPrice;\n    localStorage.setItem('cart', JSON.stringify(cart));\n    dispatch(manageCartData());\n    props.toggle();\n    /* set cart data to a spacific format end*/\n  };\n\n  useEffect(() => {\n    if (props.item) {\n      setTempChildData({});\n      let depCustom = props.item.customize.filter(list => list.is_dependent);\n      let depVarObj = {};\n      depCustom.map(data => {\n        let dWithId = data['dependent_with'];\n        let varListRow = [];\n        let dependentCustome = props.item.customize.find(dataCus => dataCus._id == data.dependent_with);\n        let defaultSelectedVarID = dependentCustome.variants.find(defVar => defVar.isDefault == true);\n\n        if (defaultSelectedVarID !== undefined) {\n          data.variants.map(varList => {\n            let price = varList.dependent_price.find(raw => raw.varientId == defaultSelectedVarID._id);\n\n            if (price !== undefined) {\n              varListRow.push({\n                _id: varList._id,\n                title: varList.title,\n                price: price,\n                isDefault: varList.isDefault\n              });\n            }\n          });\n        }\n\n        if (!variant.hasOwnProperty(dWithId)) {\n          depVarObj = {};\n          depVarObj[data['_id']] = varListRow;\n        } else {\n          depVarObj = variant[dWithId];\n          depVarObj[data['_id']] = varListRow;\n        }\n\n        variant[dWithId] = depVarObj;\n      });\n      setVariant(_objectSpread({}, variant));\n    }\n\n    setItem(props.item);\n  }, [props.item]);\n  useEffect(() => {\n    if (item) {\n      calculatePrice(); // console.log('tempChildData',tempChildData);\n\n      if (Object.keys(tempChildData).length != 0) resetChildDep(tempChildData);\n    }\n  }, [variant, quantity]);\n  console.log(\"item\", item);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(Modal, {\n      isOpen: props.isOpen,\n      className: `${styles.ModalCustom} modal-dialog-scrollable`,\n      children: [/*#__PURE__*/_jsxDEV(ModalHeader, {\n        className: \"modelHeader\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"modelHeaderTitle\",\n          children: item ? item.title : ''\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 238,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bg-close\",\n          onClick: props.toggle\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 239,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ModalBody, {\n        className: \"modelBody\",\n        children: /*#__PURE__*/_jsxDEV(Row, {\n          children: [/*#__PURE__*/_jsxDEV(Col, {\n            lg: \"3\",\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"itemImageBox\",\n              children: /*#__PURE__*/_jsxDEV(\"img\", {\n                src: item && (item === null || item === void 0 ? void 0 : item.image),\n                className: \"itemImage\",\n                alt: \"Cart\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 245,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 244,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            lg: \"9\",\n            className: \"itemDetails p-0\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"itemPrice\",\n              children: [\"\\xA3\", item ? Number(item === null || item === void 0 ? void 0 : item.price) : '']\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 249,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"itemDescription\",\n              children: item ? item === null || item === void 0 ? void 0 : item.description : ''\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 248,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(Col, {\n            lg: \"12\",\n            className: \"allItemsBody\",\n            children: item && item.customize ? item.customize.map(cusList => cusList.is_dependent ? Object.keys(variant).length != 0 && variant[cusList.dependent_with][cusList._id].length != 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              id: cusList._id,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: `${styles.titleOptional} modelItemTitle `,\n                children: cusList.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 261,\n                columnNumber: 53\n              }, this), /*#__PURE__*/_jsxDEV(Form, {\n                id: `var_${cusList._id}`,\n                className: \"cat\",\n                children: variant[cusList.dependent_with][cusList._id].map(varList => /*#__PURE__*/_jsxDEV(FormGroup, {\n                  style: {\n                    marginBottom: \"0\"\n                  },\n                  children: /*#__PURE__*/_jsxDEV(Label, {\n                    children: [/*#__PURE__*/_jsxDEV(Input, {\n                      name: cusList._id,\n                      value: varList._id,\n                      price: varList.price.price,\n                      type: cusList.is_multiple ? \"checkbox\" : \"radio\",\n                      className: `${styles.checkInput}`,\n                      onChange: handelChange,\n                      defaultChecked: varList.isDefault ? true : false\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 266,\n                      columnNumber: 69\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                        className: `${cusList.is_multiple ? styles.checkmark : styles.radio}`\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 275,\n                        columnNumber: 73\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        className: `${styles.checktext}`,\n                        style: {\n                          margin: \"0\",\n                          fontWeight: \"700\"\n                        },\n                        children: [varList.title, \" \\xA3\", varList.price.price]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 276,\n                        columnNumber: 73\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 274,\n                      columnNumber: 69\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 265,\n                    columnNumber: 65\n                  }, this)\n                }, varList._id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 264,\n                  columnNumber: 61\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 262,\n                columnNumber: 53\n              }, this)]\n            }, cusList._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 260,\n              columnNumber: 49\n            }, this) : '' : cusList.variants && cusList.variants.length != 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n              id: cusList._id,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: `${styles.titleOptional} modelItemTitle`,\n                children: cusList.title\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 289,\n                columnNumber: 49\n              }, this), /*#__PURE__*/_jsxDEV(Form, {\n                id: `var_${cusList._id}`,\n                className: \"cat\",\n                children: cusList.variants.map(varList => /*#__PURE__*/_jsxDEV(FormGroup, {\n                  style: {\n                    marginBottom: \"0\"\n                  },\n                  children: /*#__PURE__*/_jsxDEV(Label, {\n                    children: [/*#__PURE__*/_jsxDEV(Input, {\n                      name: cusList._id,\n                      value: varList._id,\n                      price: varList.price,\n                      type: cusList.is_multiple ? \"checkbox\" : \"radio\",\n                      className: `${styles.checkInput}`,\n                      onChange: handelChange,\n                      defaultChecked: varList.isDefault ? true : false\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 294,\n                      columnNumber: 65\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                        className: `${cusList.is_multiple ? styles.checkmark : styles.radio}`\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 303,\n                        columnNumber: 69\n                      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n                        className: `${styles.checktext}`,\n                        style: {\n                          margin: \"0\",\n                          fontWeight: \"700\"\n                        },\n                        children: [varList.title, \" \\xA3\", varList.price]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 304,\n                        columnNumber: 69\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 302,\n                      columnNumber: 65\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 293,\n                    columnNumber: 61\n                  }, this)\n                }, varList._id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 292,\n                  columnNumber: 57\n                }, this))\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 290,\n                columnNumber: 49\n              }, this)]\n            }, cusList._id, true, {\n              fileName: _jsxFileName,\n              lineNumber: 288,\n              columnNumber: 45\n            }, this) : \"\") : ''\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 252,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 242,\n          columnNumber: 21\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 241,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(ModalFooter, {\n        className: \"modelFooter\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"footerQuantityBtn\",\n          children: /*#__PURE__*/_jsxDEV(QuantityBtn, {\n            defvalue: 1,\n            minValue: 1,\n            getQuantity: getQuantity\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 321,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 320,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"footerADDtoCartBtn\",\n          role: \"button\",\n          onClick: addItemToCart,\n          children: /*#__PURE__*/_jsxDEV(\"a\", {\n            className: `${styles.themeBtn}`,\n            children: [\"Add to Cart - \", /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"\\xA3\", itemPrice]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 327,\n              columnNumber: 145\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 95\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 327,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 319,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 236,\n      columnNumber: 13\n    }, this)\n  }, void 0, false);\n}","map":{"version":3,"sources":["/var/www/domains/oxens.ezxdemo.com/public_html/vendor/components/Model/Cart.js"],"names":["React","useEffect","useState","styles","Row","Col","Modal","ModalHeader","ModalBody","ModalFooter","Form","FormGroup","Label","Input","Link","QuantityBtn","_","manageCartData","useDispatch","Cart","props","dispatch","variant","setVariant","item","setItem","itemPrice","setItemPrice","quantity","setQuantity","tempChildData","setTempChildData","getQuantity","data","resetChildDep","tempChild","Object","keys","length","map","childDep","selectedInput","document","querySelector","selValue","value","childCus","tempCus","customize","filter","dataCus","dependent_with","_id","varListRow","variants","varList","price","dependent_price","find","raw","varientId","undefined","push","title","isDefault","handelChange","e","cusId","currentTarget","name","type","depCus","calculatePrice","tempPrice","Number","console","log","inputs","querySelectorAll","input","checked","getAttribute","addItemToCart","cart","localStorage","getItem","JSON","parse","orderItems","storeId","totalQuantity","totalAmount","orderType","latestGroup","selectedGroup","checkedInputs","groupCheckInput","selectedGroupRaw","groupKey","slice","selectedCustom","cus","tempVar","list","is_multiple","group","menuitem","itemQuantity","stringify","toggle","depCustom","is_dependent","depVarObj","dWithId","dependentCustome","defaultSelectedVarID","defVar","hasOwnProperty","isOpen","ModalCustom","image","description","cusList","titleOptional","marginBottom","checkInput","checkmark","radio","checktext","margin","fontWeight","themeBtn"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport styles from '../../styles/cart.module.css'\nimport { Row, Col, Modal, ModalHeader, ModalBody, ModalFooter, Form, FormGroup, Label, Input } from 'reactstrap'\nimport Link from 'next/link'\nimport QuantityBtn from '../quantityBtn'\nimport _ from \"lodash\";\nimport { manageCartData } from '../../reducers/mainSlice'\nimport { useDispatch } from 'react-redux'\nimport \"../../styles/cartModel.css\"\n\nexport default function Cart(props) {\n\n    const dispatch = useDispatch()\n    const [variant, setVariant] = useState({})\n    const [item, setItem] = useState(null)\n    const [itemPrice, setItemPrice] = useState(0.00)\n    const [quantity, setQuantity] = useState(1)\n    const [tempChildData, setTempChildData] = useState({})\n\n    const getQuantity = (data) => {\n        setQuantity(data)\n    }\n    \n    const resetChildDep = (data) =>{\n        // console.log('data',data);\n        let tempChild={}\n        if (Object.keys(data).length!=0) {\n            Object.keys(data).map(childDep=>{\n                let selectedInput = document.querySelector(`input[name=\"${childDep}\"]:checked`)\n                let selValue = selectedInput?selectedInput.value:''\n                data[childDep].childCus.map(tempCus=>{\n                    let childCus = props.item.customize.filter(dataCus=>dataCus.dependent_with==tempCus._id);\n                        if (childCus.length!=0) {\n                            tempChild[tempCus._id] = {\n                                childCus:childCus,\n                                data:data,\n                            }\n                        }\n                    let varListRow = []\n                    tempCus.variants.map(varList=>{\n                        let price = varList.dependent_price.find(raw=>raw.varientId==selValue);\n                        if (price!==undefined) {\n                            varListRow.push({\n                                _id:varList._id,\n                                title: varList.title,\n                                price: price,\n                                isDefault: varList.isDefault,\n                            })  \n                        }\n                    })\n                    variant[childDep][tempCus._id] = varListRow\n                })\n            })\n            setVariant({...variant})\n            setTempChildData(tempChild) \n        }\n    }\n\n    const handelChange =  (e) => {\n        let cusId = e.currentTarget.name\n        let type = e.currentTarget.type\n        let tempChild={}\n        if (type=='radio') {\n            let depCus = props.item.customize.filter(dataCus=>dataCus.dependent_with==cusId)\n            if (depCus.length!=0) {\n                depCus.map(data=>{\n                    let childCus = props.item.customize.filter(dataCus=>dataCus.dependent_with==data._id);\n                    if (childCus.length!=0) {\n                        // console.log(data.title,' childCus',childCus);\n                        tempChild[data._id] = {\n                            childCus:childCus,\n                            data:data,\n                        }\n                    }\n                    let varListRow=[]\n                    data.variants.map(varList=>{\n                        let price = varList.dependent_price.find(raw=>raw.varientId==e.currentTarget.value);\n                        if (price!==undefined) {\n                            varListRow.push({\n                                _id:varList._id,\n                                title: varList.title,\n                                price: price,\n                                isDefault: varList.isDefault,\n                            })  \n                        }\n                    })\n                    variant[cusId][data._id] = varListRow;\n                })\n                setVariant({...variant}) \n                setTempChildData(tempChild)\n            }\n        }\n        calculatePrice()\n    }\n\n    const calculatePrice = () => {\n        let tempPrice = Number(item.price);\n        console.log(\"item price\", tempPrice);\n        item.customize.map(data => { \n            let inputs = document.querySelectorAll(`input[name=\"${data._id}\"]`)\n            for (const input of inputs) {\n                if (input.checked) {\n                    tempPrice += Number(input.getAttribute('price'))\n                }\n            }\n        })\n        // console.log('tempPrice',tempPrice);\n        setItemPrice(tempPrice * quantity)\n    }\n\n    const addItemToCart = () => {\n        let cart = localStorage.getItem('cart')?JSON.parse(localStorage.getItem('cart')):{\n            orderItems:{},\n            storeId:props.storeId,\n            totalQuantity:0,\n            totalAmount:0.00,\n            orderType:0\n        }\n        let latestGroup = cart.orderItems[item._id]?cart.orderItems[item._id].latestGroup : []\n        let selectedGroup = cart.orderItems[item._id]?cart.orderItems[item._id].selectedGroup : {}\n        /* find all checked input and group tham start*/\n            let checkedInputs={}\n            item.customize.map(data => {\n                let groupCheckInput = []\n                let inputs = document.querySelectorAll(`input[name=\"${data._id}\"]`)\n                for (const input of inputs) {\n                if (input.checked)\n                groupCheckInput.push(input)\n                }\n                checkedInputs[data._id]=groupCheckInput\n            })\n        /* find all checked input and group tham End*/\n        /* Find and create a selected group start */\n            let selectedGroupRaw=[]\n            let groupKey=item._id+\"_\"\n            Object.keys(checkedInputs).map(inputs=>{\n                groupKey+=inputs.slice(inputs.length - 6)\n                let selectedCustom = item.customize.find(cus=> cus._id == inputs)\n                let varListRow=[]\n                checkedInputs[inputs].map(input=>{\n                    let tempVar = selectedCustom.variants.find(list => list._id == input.value)\n                    groupKey+='_'+tempVar._id.slice(tempVar._id.length-6)\n                    varListRow.push({\n                        _id:tempVar._id,\n                        title: tempVar.title,\n                        price: input.getAttribute('price'),\n                    })\n                })\n                if (varListRow.length!=0) {\n                    selectedGroupRaw.push(\n                        {\n                            _id: selectedCustom._id,\n                            title: selectedCustom.title,\n                            is_multiple: selectedCustom.is_multiple,\n                            variants:varListRow\n                        }\n                    ) \n                }\n            })\n            selectedGroup[groupKey]={\n                group:selectedGroupRaw,\n                quantity:selectedGroup[groupKey]?selectedGroup[groupKey].quantity+quantity:quantity,\n                price:selectedGroup[groupKey]?selectedGroup[groupKey].price+itemPrice:itemPrice\n            }\n            latestGroup=selectedGroupRaw\n        /* Find and create a selected group end */\n        /* set cart data to a spacific format start*/   \n            cart.orderItems[item._id]= {\n                menuitem:item,\n                selectedGroup:selectedGroup,\n                latestGroup:latestGroup,\n                itemQuantity:cart.orderItems[item._id]?cart.orderItems[item._id].itemQuantity+quantity:quantity,\n                itemPrice:cart.orderItems[item._id]?cart.orderItems[item._id].itemPrice+itemPrice:itemPrice\n\n            }\n            if (!cart.storeId) {\n                cart.storeId = props.storeId\n            }\n            cart.totalQuantity+=quantity\n            cart.totalAmount+=itemPrice\n            localStorage.setItem('cart',JSON.stringify(cart))\n            dispatch(manageCartData())\n            props.toggle()\n        /* set cart data to a spacific format end*/\n    }\n\n    useEffect(() => {\n        if (props.item) {\n            setTempChildData({})\n            let depCustom = props.item.customize.filter(list=>list.is_dependent)\n            let depVarObj = {}\n            depCustom.map(data=>{\n                let dWithId = data['dependent_with'];\n                let varListRow=[]\n                let dependentCustome = props.item.customize.find(dataCus=>dataCus._id==data.dependent_with)\n                let defaultSelectedVarID = dependentCustome.variants.find(defVar=>defVar.isDefault==true)      \n                if (defaultSelectedVarID!==undefined) {\n                    data.variants.map(varList=>{\n                        let price = varList.dependent_price.find(raw=>raw.varientId==defaultSelectedVarID._id); \n                        if (price!==undefined) {\n                            varListRow.push({\n                                _id:varList._id,\n                                title: varList.title,\n                                price: price,\n                                isDefault: varList.isDefault,\n                            })    \n                        }\n                    })  \n                }\n                if(!variant.hasOwnProperty(dWithId)){\n                    depVarObj ={}\n                    depVarObj[data['_id']] =  varListRow;\n                } else {\n                    depVarObj = variant[dWithId];\n                    depVarObj[data['_id']] =  varListRow;\n                }\n                variant[dWithId] = depVarObj\n            })\n            setVariant({...variant})\n        }\n        setItem(props.item)\n    }, [props.item])\n\n    useEffect(() => {\n        if(item){\n            calculatePrice()\n            // console.log('tempChildData',tempChildData);\n            if (Object.keys(tempChildData).length!=0)\n                resetChildDep(tempChildData)\n        }\n    }, [variant,quantity])\n    console.log(\"item\", item);\n    return (\n        <>\n        \n            <Modal isOpen={props.isOpen} className={`${styles.ModalCustom} modal-dialog-scrollable`}>\n                <ModalHeader className=\"modelHeader\">\n                    <div className=\"modelHeaderTitle\">{item?item.title:''}</div>\n                    <div className=\"bg-close\" onClick={props.toggle}></div>\n                </ModalHeader>\n                <ModalBody className='modelBody'>\n                    <Row>\n                        <Col lg=\"3\" >\n                            <span className='itemImageBox'>\n                                <img src={item && item?.image} className=\"itemImage\" alt=\"Cart\" />\n                            </span>\n                        </Col>\n                        <Col lg=\"9\"  className='itemDetails p-0'>\n                            <div className='itemPrice' >£{ item ? Number(item?.price) : ''}</div>\n                            <div className='itemDescription'>{ item ? item?.description : ''}</div>\n                        </Col>\n                        <Col lg=\"12\" className='allItemsBody'>\n                            {item && item.customize\n                                ?\n                                    item.customize.map(cusList=>(\n                                        cusList.is_dependent\n                                        ?\n                                            Object.keys(variant).length!=0 && variant[cusList.dependent_with][cusList._id].length!=0 \n                                            ?\n                                                <div id={cusList._id} key={cusList._id}>\n                                                    <div className={`${styles.titleOptional} modelItemTitle `}>{cusList.title}</div>\n                                                    <Form id={`var_${cusList._id}`} className=\"cat\">\n                                                        {variant[cusList.dependent_with][cusList._id].map(varList=>(\n                                                            <FormGroup key={varList._id}  style={{marginBottom:\"0\"}}>\n                                                                <Label>\n                                                                    <Input \n                                                                        name={cusList._id} \n                                                                        value={varList._id}\n                                                                        price={varList.price.price}\n                                                                        type={cusList.is_multiple?\"checkbox\":\"radio\"} className={`${styles.checkInput}`} \n                                                                        onChange={handelChange} \n                                                                        defaultChecked={varList.isDefault?true:false} \n                                                                    />\n                                                                    <span>\n                                                                        <p className={`${cusList.is_multiple?styles.checkmark:styles.radio}`}></p>\n                                                                        <p className={`${styles.checktext}`} style={{margin:\"0\", fontWeight:\"700\"}}>{varList.title} £{varList.price.price}</p>\n                                                                    </span>\n                                                                </Label>\n                                                                {/* <span className={`${styles.customizePrice}`}>£{varList.price.price}</span> */}\n                                                            </FormGroup>\n                                                        ))}\n                                                    </Form>\n                                                </div>\n                                            :   ''   \n                                        :\n                                        cusList.variants && cusList.variants.length!=0\n                                        ?\n                                            <div id={cusList._id} key={cusList._id}>\n                                                <div className={`${styles.titleOptional} modelItemTitle`}>{cusList.title}</div>\n                                                <Form id={`var_${cusList._id}`} className=\"cat\">\n                                                    {cusList.variants.map(varList=>(\n                                                        <FormGroup key={varList._id} style={{marginBottom:\"0\"}}>\n                                                            <Label>\n                                                                <Input \n                                                                    name={cusList._id} \n                                                                    value={varList._id} \n                                                                    price={varList.price}\n                                                                    type={cusList.is_multiple?\"checkbox\":\"radio\"} className={`${styles.checkInput}`} \n                                                                    onChange={handelChange} \n                                                                    defaultChecked={varList.isDefault?true:false} \n                                                                />\n                                                                <span>\n                                                                    <p className={`${cusList.is_multiple?styles.checkmark:styles.radio}`}></p>\n                                                                    <p className={`${styles.checktext}`} style={{margin:\"0\", fontWeight:\"700\"}}>{varList.title} £{varList.price}</p>\n                                                                </span>\n                                                            </Label>\n                                                            {/* <span className={`${styles.customizePrice}`}>£{varList.price}</span> */}\n                                                        </FormGroup>\n                                                    ))}\n                                                </Form>\n                                            </div>\n                                        :   \"\"\n                                    ))\n                                :   ''\n                            }\n                        </Col>\n                    </Row>\n                </ModalBody>\n                <ModalFooter className='modelFooter'>\n                    <div className='footerQuantityBtn'>\n                        <QuantityBtn\n                            defvalue={1}\n                            minValue={1}\n                            getQuantity={getQuantity}\n                        />            \n                    </div>\n                    <div className='footerADDtoCartBtn' role=\"button\" onClick={addItemToCart}><a className={`${styles.themeBtn}`}>Add to Cart - <span>£{itemPrice}</span></a></div>\n                </ModalFooter>\n            </Modal>\n        </>\n    )\n}\n"]},"metadata":{},"sourceType":"module"}